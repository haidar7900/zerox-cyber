<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مدافع الأمن السيبراني - فريق Zerox</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #2dd4bf;
            --secondary-color: #a78bfa;
            --dark-bg: #0b1220;
            --darker-bg: #07101b;
            --text-color: #e6eef6;
            --card-bg: rgba(255, 255, 255, 0.05);
            --border-color: rgba(255, 255, 255, 0.1);
            --success-color: #2ed573;
            --error-color: #ff6b6b;
            --warning-color: #ffa502;
            --info-color: #3742fa;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: linear-gradient(135deg, var(--dark-bg), var(--darker-bg));
            color: var(--text-color);
            min-height: 100vh;
            line-height: 1.6;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .header p {
            font-size: 1.2rem;
            color: #94a3b8;
            max-width: 600px;
            margin: 0 auto;
        }

        .language-switch {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .lang-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            transition: all 0.3s ease;
            font-size: 14px;
            backdrop-filter: blur(10px);
        }

        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .lang-btn.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: #041025;
            font-weight: bold;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .card h3 {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .advanced-section {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .advanced-options {
            display: flex;
            gap: 12px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .advanced-options button {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: #041025;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            font-weight: 600;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
        }

        .advanced-options button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(45, 212, 191, 0.4);
        }

        /* واجهة الأسئلة */
        .game-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 4000;
            backdrop-filter: blur(5px);
        }

        .game-content {
            background: linear-gradient(135deg, var(--dark-bg), var(--darker-bg));
            padding: 30px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        .game-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--card-bg);
            border-radius: 10px;
            font-size: 0.9rem;
        }

        .game-question {
            font-size: 1.3rem;
            margin-bottom: 25px;
            color: var(--text-color);
            line-height: 1.6;
            text-align: center;
            padding: 15px;
            background: var(--card-bg);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .game-answers {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 25px;
        }

        .game-answer-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            text-align: right;
            transition: all 0.3s ease;
            font-size: 1rem;
            backdrop-filter: blur(5px);
        }

        .game-answer-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-5px);
        }

        .game-answer-btn.correct {
            background: var(--success-color);
            color: white;
        }

        .game-answer-btn.wrong {
            background: var(--error-color);
            color: white;
        }

        .game-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .game-buttons button {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: #041025;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .game-buttons button:hover {
            transform: translateY(-2px);
        }

        /* لوحة المتصدرين */
        .leaderboard-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 4000;
            backdrop-filter: blur(5px);
        }

        .leaderboard-content {
            background: linear-gradient(135deg, var(--dark-bg), var(--darker-bg));
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        .leaderboard-list {
            margin: 20px 0;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin: 8px 0;
            background: var(--card-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .leaderboard-rank {
            font-weight: bold;
            font-size: 1.1rem;
            width: 30px;
            text-align: center;
        }

        .rank-1 { color: gold; }
        .rank-2 { color: silver; }
        .rank-3 { color: #cd7f32; }

        .leaderboard-name {
            flex: 1;
            margin: 0 15px;
        }

        .leaderboard-score {
            font-weight: bold;
            color: var(--primary-color);
        }

        /* نافذة التحدي اليومي */
        .challenge-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 4000;
            backdrop-filter: blur(5px);
        }

        .challenge-content {
            background: linear-gradient(135deg, var(--dark-bg), var(--darker-bg));
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        .challenge-question {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--text-color);
            line-height: 1.5;
        }

        .challenge-answers {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .challenge-answer {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            text-align: right;
            transition: all 0.3s ease;
        }

        .challenge-answer:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-5px);
        }

        .challenge-answer.correct {
            background: var(--success-color);
            color: white;
        }

        .challenge-answer.wrong {
            background: var(--error-color);
            color: white;
        }

        .challenge-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .challenge-buttons button {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: #041025;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .enhanced-message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            z-index: 3000;
            animation: slideInRight 0.3s ease;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .enhanced-message.success {
            background: linear-gradient(45deg, var(--success-color), #1dd1a1);
        }

        .enhanced-message.error {
            background: linear-gradient(45deg, var(--error-color), #ee5a24);
        }

        .enhanced-message.info {
            background: linear-gradient(45deg, #3742fa, #5352ed);
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .progress-bar {
            height: 8px;
            background: var(--card-bg);
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .game-btn {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: #041025;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .game-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(45, 212, 191, 0.4);
        }

        .level-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            backdrop-filter: blur(5px);
        }

        .level-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .level-btn.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: #041025;
            font-weight: bold;
        }

        /* أنماط جديدة للميزات المضافة */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .achievement-card {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .achievement-card:hover {
            transform: scale(1.05);
        }

        .achievement-card.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }

        .achievement-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .achievement-title {
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .achievement-desc {
            font-size: 0.7rem;
            color: #94a3b8;
        }

        .skills-tree {
            margin-top: 15px;
        }

        .skill-node {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 10px;
            margin: 8px 0;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }

        .skill-node.unlocked {
            border-color: var(--primary-color);
            background: rgba(45, 212, 191, 0.1);
        }

        .skill-icon {
            width: 30px;
            height: 30px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
        }

        .skill-info {
            flex: 1;
        }

        .skill-name {
            font-weight: bold;
            margin-bottom: 2px;
        }

        .skill-progress {
            height: 4px;
            background: var(--card-bg);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 5px;
        }

        .skill-progress-fill {
            height: 100%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 2px;
            transition: width 0.5s ease;
        }

        .theme-selector {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .theme-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-btn.active {
            border-color: var(--primary-color);
            transform: scale(1.1);
        }

        .theme-blue { background: linear-gradient(45deg, #3b82f6, #1d4ed8); }
        .theme-green { background: linear-gradient(45deg, #10b981, #047857); }
        .theme-purple { background: linear-gradient(45deg, #8b5cf6, #7c3aed); }
        .theme-orange { background: linear-gradient(45deg, #f59e0b, #d97706); }

        .story-character {
            text-align: center;
            margin: 20px 0;
        }

        .character-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            border: 3px solid var(--border-color);
        }

        .character-info {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .character-name {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .character-level {
            font-size: 0.9rem;
            color: #94a3b8;
        }

        .simulation-area {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid var(--border-color);
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .simulation-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .simulation-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .simulation-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .ai-assistant {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 2000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            font-size: 1.5rem;
        }

        .ai-assistant:hover {
            transform: scale(1.1);
        }

        .ai-chat {
            position: fixed;
            bottom: 90px;
            left: 20px;
            width: 300px;
            background: var(--card-bg);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 2000;
            backdrop-filter: blur(10px);
            display: none;
        }

        .ai-chat.active {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .ai-header {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ai-messages {
            height: 200px;
            overflow-y: auto;
            padding: 15px;
        }

        .ai-input {
            padding: 15px;
            border-top: 1px solid var(--border-color);
        }

        .ai-input input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            font-family: 'Tajawal', sans-serif;
        }

        .ai-message {
            margin: 10px 0;
            padding: 10px;
            border-radius: 10px;
            max-width: 80%;
        }

        .ai-user {
            background: rgba(59, 130, 246, 0.2);
            margin-left: 50px;
            text-align: left;
        }

        .ai-bot {
            background: rgba(45, 212, 191, 0.2);
            margin-right: 50px;
            text-align: right;
        }

        .typing-indicator {
            display: inline-block;
            margin-right: 10px;
        }

        .typing-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary-color);
            margin: 0 2px;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* تسجيل الدخول */
        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 5000;
            backdrop-filter: blur(10px);
        }

        .login-content {
            background: linear-gradient(135deg, var(--dark-bg), var(--darker-bg));
            padding: 40px;
            border-radius: 20px;
            max-width: 400px;
            width: 90%;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        .login-content h2 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--primary-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #94a3b8;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .login-btn {
            width: 100%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: #041025;
            border: none;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(45, 212, 191, 0.4);
        }

        @media (max-width: 768px) {
            .language-switch {
                top: 10px;
                left: 10px;
            }
            
            .lang-btn {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            .advanced-options {
                flex-direction: column;
            }
            
            .advanced-options button {
                min-width: auto;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 1rem;
            }

            .ai-chat {
                width: calc(100vw - 40px);
                left: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- نافذة تسجيل الدخول -->
    <div class="login-modal" id="loginModal">
        <div class="login-content">
            <h2>🎮 مرحباً في مدافع الأمن السيبراني</h2>
            <div class="form-group">
                <label for="playerName">اسم اللاعب:</label>
                <input type="text" id="playerName" placeholder="أدخل اسمك" maxlength="20">
            </div>
            <div class="form-group">
                <label for="playerAge">العمر:</label>
                <input type="number" id="playerAge" placeholder="أدخل عمرك" min="10" max="100">
            </div>
            <div class="form-group">
                <label for="playerCountry">البلد:</label>
                <input type="text" id="playerCountry" placeholder="بلدك">
            </div>
            <button class="login-btn" onclick="gameManager.registerPlayer()">بدء اللعبة 🚀</button>
        </div>
    </div>

    <div class="container" id="mainContainer" style="display: none;">
        <div class="header">
            <div class="language-switch">
                <button class="lang-btn active" onclick="gameManager.switchLanguage('ar')">🌐 العربية</button>
                <button class="lang-btn" onclick="gameManager.switchLanguage('en')">🌐 English</button>
            </div>
            <h1>مدافع الأمن السيبراني</h1>
            <p>لعبة تعليمية عن الأمن السيبراني — فريق Zerox</p>
            <p style="margin-top: 10px; font-size: 0.9rem; color: #64748b;">تصميم: المهندس حيدر الجنابي</p>
        </div>
        
        <div class="main-content">
            <div class="content-area">
                <div class="card">
                    <h3>أهلاً بك أيها المدافع 🛡️</h3>
                    <p style="color: #94a3b8; margin-bottom: 20px;" id="welcomeMessage">احمِ الحسابات وتعلم أساسيات الحماية عبر أسئلة قصيرة وتحديات سريعة.</p>
                    
                    <div class="advanced-options">
                        <button class="game-btn" onclick="gameManager.startGame()">🎮 ابدأ اللعبة</button>
                        <button class="game-btn" onclick="gameManager.showHowToPlay()">📖 كيف تُلعب</button>
                        <button class="game-btn" onclick="gameManager.editProfile()">👤 تعديل الملف الشخصي</button>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h4>اختر مستوى:</h4>
                        <div class="advanced-options">
                            <button class="level-btn active" onclick="gameManager.selectLevel('easy')">🟢 سهلة</button>
                            <button class="level-btn" onclick="gameManager.selectLevel('medium')">🟡 متوسطة</button>
                            <button class="level-btn" onclick="gameManager.selectLevel('hard')">🔴 صعبة</button>
                        </div>
                    </div>
                </div>
                
                <!-- قسم جديد: الشخصية الافتراضية -->
                <div class="card">
                    <h3>👤 شخصيتك الافتراضية</h3>
                    <div class="story-character">
                        <div class="character-avatar">🛡️</div>
                        <div class="character-info">
                            <div class="character-name" id="characterName">سيظهر اسمك هنا</div>
                            <div class="character-level">المستوى: <span id="characterLevel">1</span></div>
                            <div class="character-xp">النقاط: <span id="characterXP">0</span></div>
                        </div>
                    </div>
                </div>
                
                <!-- قسم جديد: شجرة المهارات -->
                <div class="card">
                    <h3>🌳 شجرة المهارات</h3>
                    <div class="skills-tree">
                        <div class="skill-node unlocked">
                            <div class="skill-icon">🔒</div>
                            <div class="skill-info">
                                <div class="skill-name">أساسيات الأمن</div>
                                <div class="skill-progress">
                                    <div class="skill-progress-fill" style="width: 80%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="skill-node">
                            <div class="skill-icon">🛡️</div>
                            <div class="skill-info">
                                <div class="skill-name">الحماية من التصيد</div>
                                <div class="skill-progress">
                                    <div class="skill-progress-fill" style="width: 40%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="skill-node">
                            <div class="skill-icon">🔍</div>
                            <div class="skill-info">
                                <div class="skill-name">كشف التسلل</div>
                                <div class="skill-progress">
                                    <div class="skill-progress-fill" style="width: 20%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="advanced-section">
                    <div class="card">
                        <h3>🎯 الوضع المتقدم</h3>
                        <p style="color: #94a3b8; margin-bottom: 15px;">استكشف ميزات إضافية وأسئلة متقدمة</p>
                        <div class="advanced-options">
                            <button class="game-btn" onclick="gameManager.startAdvancedQuestions()">
                                🚀 الأسئلة المتقدمة
                            </button>
                            <button class="game-btn" onclick="gameManager.startDailyChallenge()">
                                🏆 التحدي اليومي
                            </button>
                            <button class="game-btn" onclick="gameManager.showLeaderboard()">
                                📊 لوحة المتصدرين
                            </button>
                            <button class="game-btn" onclick="gameManager.showAchievements()">
                                🏅 الإنجازات
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- قسم جديد: الميداليات والإنجازات -->
                <div class="card">
                    <h3>🏆 الميداليات والإنجازات</h3>
                    <div class="achievements-grid">
                        <div class="achievement-card">
                            <div class="achievement-icon">🥇</div>
                            <div class="achievement-title">المبتدئ</div>
                            <div class="achievement-desc">أكمل 10 أسئلة</div>
                        </div>
                        <div class="achievement-card locked">
                            <div class="achievement-icon">🥈</div>
                            <div class="achievement-title">المحترف</div>
                            <div class="achievement-desc">أكمل 50 سؤالاً</div>
                        </div>
                        <div class="achievement-card locked">
                            <div class="achievement-icon">🥉</div>
                            <div class="achievement-title">الخبير</div>
                            <div class="achievement-desc">أكمل 100 سؤال</div>
                        </div>
                        <div class="achievement-card">
                            <div class="achievement-icon">⚡</div>
                            <div class="achievement-title">سريع</div>
                            <div class="achievement-desc">أجب على 5 أسئلة في دقيقة</div>
                        </div>
                    </div>
                </div>
                
                <!-- قسم جديد: محاكاة الهجمات -->
                <div class="card">
                    <h3>🛡️ محاكاة الدفاع</h3>
                    <div class="simulation-area">
                        <p style="color: #94a3b8; text-align: center; margin-bottom: 15px;">تدرب على مواجهة هجمات افتراضية</p>
                        <div class="simulation-controls">
                            <button class="simulation-btn" onclick="gameManager.startSimulation('phishing')">محاكاة التصيد</button>
                            <button class="simulation-btn" onclick="gameManager.startSimulation('ddos')">محاكاة DDoS</button>
                            <button class="simulation-btn" onclick="gameManager.startSimulation('malware')">محاكاة البرمجيات الخبيثة</button>
                            <button class="simulation-btn" onclick="gameManager.startSimulation('social')">محاكاة الهندسة الاجتماعية</button>
                        </div>
                    </div>
                </div>

                <!-- قسم جديد: التقدم الأسبوعي -->
                <div class="card">
                    <h3>📅 التقدم الأسبوعي</h3>
                    <div style="margin-top: 15px;">
                        <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                            <span>الأسئلة المجابة هذا الأسبوع:</span>
                            <span id="weeklyQuestions">0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                            <span>النقاط المكتسبة:</span>
                            <span id="weeklyPoints">0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                            <span>أيام اللعب المتتالية:</span>
                            <span id="streakDays">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="card">
                    <h3>📈 التقدم</h3>
                    <p style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 10px;">مستوى واحد = 10 أسئلة</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                    </div>
                    <p style="text-align: center; font-size: 0.9rem;" id="progressText">السؤال 0 من 10</p>
                </div>
                
                <div class="card">
                    <h3>🎯 مستوى اللعبة</h3>
                    <p style="color: #94a3b8; font-size: 0.9rem; margin: 10px 0;">اختر مستوى قبل البدء</p>
                    <div style="display: flex; gap: 10px;">
                        <button class="level-btn active" onclick="gameManager.selectLevel('easy')">سهل</button>
                        <button class="level-btn" onclick="gameManager.selectLevel('medium')">متوسط</button>
                        <button class="level-btn" onclick="gameManager.selectLevel('hard')">صعب</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3>⭐ سجل اللعبة</h3>
                    <p style="color: #94a3b8; font-size: 0.9rem; margin: 10px 0;">أعلى نتيجة</p>
                    <div style="text-align: center; font-size: 2rem; font-weight: bold; color: var(--primary-color); margin: 15px 0;" id="highScore">0</div>
                    <div style="display: flex; gap: 10px;">
                        <button class="game-btn" style="background: rgba(239, 68, 68, 0.2); color: #ef4444;" onclick="gameManager.deleteRecord()">🗑️ حذف السجل</button>
                        <button class="game-btn" style="background: rgba(59, 130, 246, 0.2); color: #3b82f6;" onclick="gameManager.copyScore()">📋 نسخ</button>
                    </div>
                </div>
                
                <div class="card">
                    <h3>التحدي اليومي</h3>
                    <p style="color: #94a3b8; font-size: 0.9rem; margin: 10px 0;" id="dailyChallengeDesc">اكسب 200 نقطة إضافية!</p>
                    <button class="game-btn" style="background: linear-gradient(45deg, #ff6b6b, #ee5a24); color: white; width: 100%;" onclick="gameManager.startDailyChallenge()">
                        بدء التحدي
                    </button>
                    <p style="text-align: center; font-size: 0.8rem; color: #94a3b8; margin-top: 10px;" id="challengeStatus">متاح اليوم</p>
                </div>
                
                <!-- قسم جديد: الثيمات -->
                <div class="card">
                    <h3>🎨 تخصيص الثيم</h3>
                    <p style="color: #94a3b8; font-size: 0.9rem; margin: 10px 0;">اختر اللون المفضل</p>
                    <div class="theme-selector">
                        <div class="theme-btn theme-blue active" onclick="gameManager.changeTheme('blue')"></div>
                        <div class="theme-btn theme-green" onclick="gameManager.changeTheme('green')"></div>
                        <div class="theme-btn theme-purple" onclick="gameManager.changeTheme('purple')"></div>
                        <div class="theme-btn theme-orange" onclick="gameManager.changeTheme('orange')"></div>
                    </div>
                </div>
                
                <!-- قسم جديد: الإحصائيات -->
                <div class="card">
                    <h3>📊 إحصائياتك</h3>
                    <div style="margin-top: 10px;">
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span>إجمالي الأسئلة:</span>
                            <span id="totalQuestions">0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span>الإجابات الصحيحة:</span>
                            <span id="correctAnswers">0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span>نسبة النجاح:</span>
                            <span id="successRate">0%</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span>الوقت المستغرق:</span>
                            <span id="timeSpent">0 د</span>
                        </div>
                    </div>
                </div>

                <!-- قسم جديد: الملف الشخصي -->
                <div class="card">
                    <h3>👤 ملفك الشخصي</h3>
                    <div style="margin-top: 10px;">
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span>الاسم:</span>
                            <span id="profileName">-</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span>العمر:</span>
                            <span id="profileAge">-</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span>البلد:</span>
                            <span id="profileCountry">-</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin: 8px 0;">
                            <span>تاريخ الانضمام:</span>
                            <span id="profileJoinDate">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- مساعد الذكاء الاصطناعي -->
    <div class="ai-assistant" onclick="gameManager.toggleAIChat()">
        🤖
    </div>
    
    <div class="ai-chat" id="aiChat">
        <div class="ai-header">
            <span>مساعد الأمن السيبراني</span>
            <button onclick="gameManager.toggleAIChat()" style="background: none; border: none; color: var(--text-color); cursor: pointer;">✕</button>
        </div>
        <div class="ai-messages" id="aiMessages">
            <div class="ai-message ai-bot">
                مرحباً! أنا مساعدك في الأمن السيبراني. كيف يمكنني مساعدتك اليوم؟
            </div>
        </div>
        <div class="ai-input">
            <input type="text" id="aiInput" placeholder="اكتب سؤالك هنا..." onkeypress="if(event.key=='Enter') gameManager.sendAIMessage()">
        </div>
    </div>

    <script>
        // نظام إدارة اللعبة المحسن والمصلح
        const gameManager = {
            currentLanguage: 'ar',
            currentLevel: 'easy',
            currentQuestion: 0,
            score: 0,
            questions: {},
            leaderboard: [],
            playerStats: {
                totalQuestions: 0,
                correctAnswers: 0,
                timeSpent: 0,
                achievements: [],
                weeklyStats: {
                    questions: 0,
                    points: 0,
                    streak: 0,
                    lastPlayed: null
                }
            },
            playerProfile: {
                name: "",
                age: "",
                country: "",
                joinDate: new Date().toLocaleDateString('ar-EG')
            },
            character: {
                name: "سيظهر اسمك هنا",
                level: 1,
                xp: 0,
                skills: {
                    basics: 80,
                    phishing: 40,
                    intrusion: 20
                }
            },
            dailyChallenge: {
                completed: false,
                lastDate: null,
                currentQuestion: null
            },
            
            init() {
                this.loadPlayerProfile();
                this.loadQuestions();
                this.loadLeaderboard();
                this.loadHighScore();
                this.loadPlayerStats();
                this.updateStatsDisplay();
                this.startTimer();
                this.setupDailyChallenge();
                
                if (!this.playerProfile.name) {
                    document.getElementById('loginModal').style.display = 'flex';
                } else {
                    document.getElementById('loginModal').style.display = 'none';
                    document.getElementById('mainContainer').style.display = 'block';
                    this.showWelcomeMessage();
                }
            },
            
            registerPlayer() {
                const name = document.getElementById('playerName').value.trim();
                const age = document.getElementById('playerAge').value;
                const country = document.getElementById('playerCountry').value.trim();
                
                if (!name) {
                    alert('يرجى إدخال اسم اللاعب');
                    return;
                }
                
                this.playerProfile = {
                    name: name,
                    age: age || 'غير محدد',
                    country: country || 'غير محدد',
                    joinDate: new Date().toLocaleDateString('ar-EG')
                };
                
                // تحديث اسم الشخصية الافتراضية
                this.character.name = name;
                
                this.savePlayerProfile();
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('mainContainer').style.display = 'block';
                this.showWelcomeMessage();
                this.updateProfileDisplay();
                this.updateCharacterDisplay();
            },
            
            editProfile() {
                document.getElementById('playerName').value = this.playerProfile.name;
                document.getElementById('playerAge').value = this.playerProfile.age !== 'غير محدد' ? this.playerProfile.age : '';
                document.getElementById('playerCountry').value = this.playerProfile.country !== 'غير محدد' ? this.playerProfile.country : '';
                document.getElementById('loginModal').style.display = 'flex';
            },
            
            showWelcomeMessage() {
                const welcomeMsg = `مرحباً ${this.playerProfile.name}! 🛡️\nأنت الآن جاهز لبدء رحلتك في عالم الأمن السيبراني.`;
                this.showMessage(welcomeMsg, 'success');
                document.getElementById('welcomeMessage').textContent = `مرحباً ${this.playerProfile.name}! احمِ الحسابات وتعلم أساسيات الحماية عبر أسئلة قصيرة وتحديات سريعة.`;
            },
            
            loadPlayerProfile() {
                const saved = localStorage.getItem('cyber_defender_profile');
                if (saved) {
                    this.playerProfile = JSON.parse(saved);
                    // تحديث اسم الشخصية الافتراضية
                    this.character.name = this.playerProfile.name;
                }
            },
            
            savePlayerProfile() {
                localStorage.setItem('cyber_defender_profile', JSON.stringify(this.playerProfile));
                this.updateProfileDisplay();
            },
            
            updateProfileDisplay() {
                document.getElementById('profileName').textContent = this.playerProfile.name;
                document.getElementById('profileAge').textContent = this.playerProfile.age;
                document.getElementById('profileCountry').textContent = this.playerProfile.country;
                document.getElementById('profileJoinDate').textContent = this.playerProfile.joinDate;
            },
            
            // دالة جديدة لتحديث عرض الشخصية
            updateCharacterDisplay() {
                document.getElementById('characterName').textContent = this.character.name;
                document.getElementById('characterLevel').textContent = this.character.level;
                document.getElementById('characterXP').textContent = this.character.xp;
            },
            
            setupDailyChallenge() {
                const today = new Date().toDateString();
                const saved = localStorage.getItem('cyber_defender_daily');
                
                if (saved) {
                    const dailyData = JSON.parse(saved);
                    if (dailyData.lastDate === today) {
                        this.dailyChallenge.completed = dailyData.completed;
                        this.dailyChallenge.lastDate = dailyData.lastDate;
                    }
                }
                
                // توليد سؤال يومي عشوائي
                const allQuestions = [...this.questions.easy, ...this.questions.medium, ...this.questions.hard];
                const randomIndex = Math.floor(Math.random() * allQuestions.length);
                this.dailyChallenge.currentQuestion = allQuestions[randomIndex];
                
                this.updateChallengeDisplay();
            },
            
            updateChallengeDisplay() {
                const challengeDesc = document.getElementById('dailyChallengeDesc');
                const challengeStatus = document.getElementById('challengeStatus');
                
                if (this.dailyChallenge.completed) {
                    challengeDesc.textContent = 'أكملت التحدي اليوم!';
                    challengeStatus.textContent = 'مكتمل اليوم';
                    challengeStatus.style.color = '#2ed573';
                } else {
                    challengeDesc.textContent = 'اكسب 200 نقطة إضافية!';
                    challengeStatus.textContent = 'متاح اليوم';
                    challengeStatus.style.color = '#94a3b8';
                }
            },
            
            loadQuestions() {
                this.questions = {
                    easy: [
                        {
                            question: { ar: "ما هو أفضل كلمة مرور؟", en: "What is the best password?" },
                            answers: {
                                ar: ["123456", "password", "اسمك", "مزيج من أحرف وأرقام ورموز"],
                                en: ["123456", "password", "your name", "combination of letters, numbers and symbols"]
                            },
                            correct: 3,
                            explanation: { ar: "كلمة المرور القوية تحتوي على مزيج من الأحرف الكبيرة والصغيرة والأرقام والرموز", en: "Strong password contains mix of uppercase, lowercase, numbers and symbols" }
                        },
                        {
                            question: { ar: "ماذا يعني HTTPS في عنوان الموقع؟", en: "What does HTTPS mean in a website address?" },
                            answers: {
                                ar: ["نفس HTTP", "نسخة محسنة", "اتصال آمن", "نوع خادم"],
                                en: ["Same as HTTP", "Enhanced version", "Secure connection", "Server type"]
                            },
                            correct: 2,
                            explanation: { ar: "HTTPS يعني أن الاتصال مشفر وآمن بين المتصفح والخادم", en: "HTTPS means encrypted and secure connection between browser and server" }
                        },
                        {
                            question: { ar: "ما هو التصيد الاحتيالي (Phishing)؟", en: "What is Phishing?" },
                            answers: {
                                ar: ["نوع من السمك", "هجوم برمجيات خبيثة", "احتيال لسرقة المعلومات", "تقنية تشفير"],
                                en: ["A type of fish", "Malware attack", "Fraud to steal information", "Encryption technique"]
                            },
                            correct: 2,
                            explanation: { ar: "التصيد هو محاولة خداعك لكشف معلوماتك الشخصية مثل كلمات المرور", en: "Phishing is attempt to trick you into revealing personal information like passwords" }
                        },
                        {
                            question: { ar: "ما هو أفضل إجراء لحماية حسابك؟", en: "What is the best action to protect your account?" },
                            answers: {
                                ar: ["استخدام كلمة مرور بسيطة", "تفعيل المصادقة الثنائية", "مشاركة كلمة المرور", "عدم تغيير كلمة المرور أبداً"],
                                en: ["Use a simple password", "Enable two-factor authentication", "Share your password", "Never change your password"]
                            },
                            correct: 1,
                            explanation: { ar: "المصادقة الثنائية تضيف طبقة حماية إضافية لحسابك", en: "Two-factor authentication adds extra protection layer to your account" }
                        },
                        {
                            question: { ar: "ما هو الهدف من برامج مكافحة الفيروسات؟", en: "What is the purpose of antivirus software?" },
                            answers: {
                                ar: ["تسريع الكمبيوتر", "اكتشاف وإزالة البرمجيات الضارة", "زيادة مساحة التخزين", "تحسين الاتصال بالإنترنت"],
                                en: ["Speed up the computer", "Detect and remove malicious software", "Increase storage space", "Improve internet connection"]
                            },
                            correct: 1,
                            explanation: { ar: "برامج مكافحة الفيروسات تحمي جهازك من البرمجيات الخبيثة", en: "Antivirus software protects your device from malicious software" }
                        },
                        {
                            question: { ar: "ما هو التحديث الأمني؟", en: "What is a security update?" },
                            answers: {
                                ar: ["إصدار جديد من البرنامج", "إصلاح ثغرات أمنية", "تغيير واجهة المستخدم", "إضافة ميزات جديدة"],
                                en: ["New software version", "Fix security vulnerabilities", "Change user interface", "Add new features"]
                            },
                            correct: 1,
                            explanation: { ar: "التحديثات الأمنية تصلح الثغرات التي يمكن للمخترقين استغلالها", en: "Security updates fix vulnerabilities that hackers can exploit" }
                        },
                        {
                            question: { ar: "ما هو الواي فاي العام؟", en: "What is public Wi-Fi?" },
                            answers: {
                                ar: ["شبكة لاسلكية مفتوحة للجميع", "شبكة خاصة بالمنزل", "شبكة سريعة جداً", "نوع من الهواتف"],
                                en: ["Open wireless network for everyone", "Home private network", "Very fast network", "Type of phone"]
                            },
                            correct: 0,
                            explanation: { ar: "شبكات الواي فاي العامة قد تكون غير آمنة ويجب تجنب إجراء المعاملات الحساسة عليها", en: "Public Wi-Fi networks may be insecure and you should avoid sensitive transactions" }
                        },
                        {
                            question: { ar: "ما هو خطر استخدام شبكات الواي فاي العامة؟", en: "What is the risk of using public Wi-Fi networks?" },
                            answers: {
                                ar: ["بطء الإنترنت", "انقطاع الاتصال", "اختراق البيانات", "استهلاك البطارية"],
                                en: ["Slow internet", "Connection interruption", "Data breach", "Battery consumption"]
                            },
                            correct: 2,
                            explanation: { ar: "شبكات الواي فاي العامة قد تسمح للمخترقين بسرقة بياناتك", en: "Public Wi-Fi may allow hackers to steal your data" }
                        },
                        {
                            question: { ar: "ما هو أفضل إجراء عند تلقي بريد إلكتروني مشبوه؟", en: "What is the best action when receiving a suspicious email?" },
                            answers: {
                                ar: ["فتحه فوراً", "حذفه دون فتح", "الرد عليه", "إعادة توجيهه للأصدقاء"],
                                en: ["Open it immediately", "Delete it without opening", "Reply to it", "Forward it to friends"]
                            },
                            correct: 1,
                            explanation: { ar: "البريد الإلكتروني المشبوه قد يحتوي على روابط أو مرفقات ضارة", en: "Suspicious email may contain malicious links or attachments" }
                        },
                        {
                            question: { ar: "ما هو الهدف من النسخ الاحتياطي؟", en: "What is the purpose of backup?" },
                            answers: {
                                ar: ["تسريع الجهاز", "حماية البيانات من الفقد", "زيادة الأمان", "تحسين الأداء"],
                                en: ["Speed up the device", "Protect data from loss", "Increase security", "Improve performance"]
                            },
                            correct: 1,
                            explanation: { ar: "النسخ الاحتياطي يحمي بياناتك في حالة فقدانها بسبب هجوم أو عطل", en: "Backup protects your data in case of loss due to attack or failure" }
                        }
                    ],
                    medium: [
                        {
                            question: { ar: "كيف يعمل هجوم DDoS؟", en: "How does a DDoS attack work?" },
                            answers: {
                                ar: ["باختراق كلمة المرور", "بإغراق الخادم بطلبات زائفة", "بسرقة البيانات", "بتشفير الملفات"],
                                en: ["By cracking passwords", "By flooding the server with fake requests", "By stealing data", "By encrypting files"]
                            },
                            correct: 1,
                            explanation: { ar: "هجوم DDoS يغرق الخادم بكمية هائلة من الطلبات مما يجعله غير قادر على الاستجابة", en: "DDoS attack floods server with massive requests making it unable to respond" }
                        },
                        {
                            question: { ar: "ما هو هجوم الوسيط (Man-in-the-Middle)؟", en: "What is a Man-in-the-Middle attack?" },
                            answers: {
                                ar: ["هجوم على الخوادم", "اعتراض الاتصال بين طرفين", "هجوم بكلمات المرور", "هجوم على البنية التحتية"],
                                en: ["Attack on servers", "Intercepting communication between two parties", "Password attack", "Infrastructure attack"]
                            },
                            correct: 1,
                            explanation: { ar: "المهاجم يعترض الاتصال بين طرفين ويتنصت أو يغير البيانات", en: "Attacker intercepts communication between two parties and eavesdrops or alters data" }
                        },
                        {
                            question: { ar: "ما هو التشفير؟", en: "What is encryption?" },
                            answers: {
                                ar: ["حذف البيانات", "تحويل البيانات إلى شكل غير مقروء", "نسخ البيانات", "ضغط البيانات"],
                                en: ["Deleting data", "Converting data to unreadable form", "Copying data", "Compressing data"]
                            },
                            correct: 1,
                            explanation: { ar: "التشفير يحمي البيانات بتحويلها إلى شكل لا يمكن قراءته بدون مفتاح فك التشفير", en: "Encryption protects data by converting it to unreadable form without decryption key" }
                        },
                        {
                            question: { ar: "ما هو الاختلاف بين التصيد والتصيد المستهدف؟", en: "What is the difference between phishing and spear phishing?" },
                            answers: {
                                ar: ["لا يوجد فرق", "التصيد المستهدف موجه لأفراد محددين", "التصيد المستهدف أسهل", "التصيد المستهدف لا يستخدم البريد الإلكتروني"],
                                en: ["No difference", "Spear phishing targets specific individuals", "Spear phishing is easier", "Spear phishing doesn't use email"]
                            },
                            correct: 1,
                            explanation: { ar: "التصيد المستهدف أكثر تخصيصاً ويستهدف أفراداً أو منظمات محددة", en: "Spear phishing is more personalized and targets specific individuals or organizations" }
                        },
                        {
                            question: { ar: "ما هو برنامج الفدية (Ransomware)؟", en: "What is Ransomware?" },
                            answers: {
                                ar: ["برنامج يحمي من الفيروسات", "برنامج يشفّر الملفات ويطلب فدية", "برنامج لتحسين الأداء", "برنامج للنسخ الاحتياطي"],
                                en: ["Software that protects from viruses", "Software that encrypts files and demands ransom", "Software to improve performance", "Backup software"]
                            },
                            correct: 1,
                            explanation: { ar: "برامج الفدية تشفر ملفاتك وتطلب فدية مقابل إعادتها", en: "Ransomware encrypts your files and demands ransom to restore them" }
                        },
                        {
                            question: { ar: "ما هو جدار الحماية (Firewall)؟", en: "What is a Firewall?" },
                            answers: {
                                ar: ["جهاز لتسريع الإنترنت", "نظام لمراقبة وفلترة حركة المرور", "برنامج لمكافحة الفيروسات", "أداة لتحسين البطارية"],
                                en: ["Device to speed up internet", "System to monitor and filter traffic", "Antivirus software", "Tool to improve battery"]
                            },
                            correct: 1,
                            explanation: { ar: "جدار الحماية يراقب ويراقب حركة المرور الشبكية ويمنع الوصول غير المصرح به", en: "Firewall monitors and controls network traffic and prevents unauthorized access" }
                        },
                        {
                            question: { ar: "ما هو اختبار الاختراق (Penetration Testing)؟", en: "What is Penetration Testing?" },
                            answers: {
                                ar: ["هجوم حقيقي على الأنظمة", "اختبار أمني محاكى لاكتشاف الثغرات", "فحص سرعة الشبكة", "تحليل بيانات المستخدم"],
                                en: ["Real attack on systems", "Simulated security test to discover vulnerabilities", "Network speed test", "User data analysis"]
                            },
                            correct: 1,
                            explanation: { ar: "اختبار الاختراق هو فحص أمني محاكٍ لاكتشاف نقاط الضعف قبل أن يستغلها المخترقون", en: "Penetration testing is simulated security examination to discover vulnerabilities before hackers exploit them" }
                        },
                        {
                            question: { ar: "ما هو نظام كشف التسلل (IDS)؟", en: "What is an Intrusion Detection System (IDS)?" },
                            answers: {
                                ar: ["نظام لمنع الهجمات", "نظام لمراقبة الشبكة لاكتشاف الهجمات", "نظام لتسريع الشبكة", "نظام لتحسين الأمان المادي"],
                                en: ["System to prevent attacks", "System to monitor network for detecting attacks", "System to speed up network", "System to improve physical security"]
                            },
                            correct: 1,
                            explanation: { ar: "نظام كشف التسلل يراقب الشبكة ويكتشف محاولات الاختراق", en: "Intrusion Detection System monitors network and detects breach attempts" }
                        },
                        {
                            question: { ar: "ما هو البصمة الرقمية (Digital Footprint)؟", en: "What is a Digital Footprint?" },
                            answers: {
                                ar: ["بصمة الإصبع الرقمية", "آثار البيانات التي تتركها على الإنترنت", "توقيع رقمي", "هوية رقمية"],
                                en: ["Digital fingerprint", "Data traces you leave on the internet", "Digital signature", "Digital identity"]
                            },
                            correct: 1,
                            explanation: { ar: "البصمة الرقمية هي جميع البيانات التي تتركها عن نفسك على الإنترنت", en: "Digital footprint is all data you leave about yourself on the internet" }
                        },
                        {
                            question: { ar: "ما هو التصيد بالرمح (Spear Phishing)؟", en: "What is Spear Phishing?" },
                            answers: {
                                ar: ["هجوم عشوائي بالبريد الإلكتروني", "هجوم موجه لشخص أو منظمة محددة", "هجوم على خوادم البريد", "هجوم على كلمات المرور"],
                                en: ["Random email attack", "Targeted attack on specific person or organization", "Attack on mail servers", "Password attack"]
                            },
                            correct: 1,
                            explanation: { ar: "التصيد بالرمح يستهدف شخصاً أو منظمة محددة بمحتوى مخصص ومخادع", en: "Spear phishing targets specific person or organization with customized deceptive content" }
                        }
                    ],
                    hard: [
                        {
                            question: { ar: "ما هو هجوم حقن SQL؟", en: "What is an SQL injection attack?" },
                            answers: {
                                ar: ["هجوم على قواعد البيانات", "هجوم على الشبكات", "هجوم على كلمات المرور", "هجوم على البريد الإلكتروني"],
                                en: ["Attack on databases", "Attack on networks", "Attack on passwords", "Attack on email"]
                            },
                            correct: 0,
                            explanation: { ar: "هجوم حقن SQL يستغل ثغرات في تطبيقات الويب للوصول إلى قواعد البيانات", en: "SQL injection exploits vulnerabilities in web applications to access databases" }
                        },
                        {
                            question: { ar: "ما هو هجوم XSS؟", en: "What is an XSS attack?" },
                            answers: {
                                ar: ["هجوم على الخوادم", "حقن أكواد ضارة في صفحات الويب", "هجوم على كلمات المرور", "هجوم على الشبكات"],
                                en: ["Attack on servers", "Injecting malicious code into web pages", "Attack on passwords", "Attack on networks"]
                            },
                            correct: 1,
                            explanation: { ar: "هجوم XSS يحقن أكواد JavaScript ضارة في صفحات الويب التي يزورها المستخدمون", en: "XSS attack injects malicious JavaScript code into web pages visited by users" }
                        },
                        {
                            question: { ar: "ما هو اختبار القلم (Pen Testing)؟", en: "What is Pen Testing?" },
                            answers: {
                                ar: ["اختبار الأقلام الإلكترونية", "اختبار اختراق الأنظمة", "اختبار سرعة الكتابة", "اختبار الشبكات اللاسلكية"],
                                en: ["Testing electronic pens", "Testing system penetration", "Testing typing speed", "Testing wireless networks"]
                            },
                            correct: 1,
                            explanation: { ar: "اختبار الاختراق هو فحص أمني محاكٍ لتقييم أمان الأنظمة والشبكات", en: "Penetration testing is simulated security assessment to evaluate system and network security" }
                        },
                        {
                            question: { ar: "ما هو الاختلاف بين IDS و IPS؟", en: "What is the difference between IDS and IPS?" },
                            answers: {
                                ar: ["نفس النظام", "IDS يرصد فقط، IPS يرصد ويمنع", "IDS للشبكات الصغيرة", "لا فرق"],
                                en: ["Same system", "IDS only detects, IPS detects and prevents", "IDS for small networks", "No difference"]
                            },
                            correct: 1,
                            explanation: { ar: "IDS يرصد الهجمات فقط بينما IPS يرصدها ويمنعها تلقائياً", en: "IDS only detects attacks while IPS detects and automatically prevents them" }
                        },
                        {
                            question: { ar: "ما هو Zero-Knowledge Proof؟", en: "What is Zero-Knowledge Proof?" },
                            answers: {
                                ar: ["إثبات بدون كشف المعلومات", "تشفير بدون مفتاح", "حذف البيانات", "مشاركة المعلومات"],
                                en: ["Proof without revealing information", "Encryption without keys", "Data deletion", "Information sharing"]
                            },
                            correct: 0,
                            explanation: { ar: "إثبات المعرفة الصفرية يسمح بإثبات صحة معلومة دون الكشف عن المعلومة نفسها", en: "Zero-knowledge proof allows proving validity of information without revealing the information itself" }
                        },
                        {
                            question: { ar: "ما هو هجوم القوة الغاشمة (Brute Force)؟", en: "What is a Brute Force attack?" },
                            answers: {
                                ar: ["هجوم على الشبكات", "تجربة جميع التركيبات الممكنة لكلمة المرور", "هجوم على الخوادم", "هجوم على التطبيقات"],
                                en: ["Attack on networks", "Trying all possible password combinations", "Attack on servers", "Attack on applications"]
                            },
                            correct: 1,
                            explanation: { ar: "هجوم القوة الغاشمة يحاول كسر كلمات المرور بتجربة جميع التركيبات الممكنة", en: "Brute force attack attempts to crack passwords by trying all possible combinations" }
                        },
                        {
                            question: { ar: "ما هو هجوم الهندسة الاجتماعية؟", en: "What is a Social Engineering attack?" },
                            answers: {
                                ar: ["هجوم على البرمجيات", "خداع الأشخاص للكشف عن معلومات حساسة", "هجوم على الأجهزة", "هجوم على الشبكات"],
                                en: ["Attack on software", "Deceiving people to reveal sensitive information", "Attack on devices", "Attack on networks"]
                            },
                            correct: 1,
                            explanation: { ar: "الهندسة الاجتماعية تخدع الأشخاص نفسياً لكشف معلومات حساسة بدلاً من اختراق الأنظمة", en: "Social engineering deceives people psychologically to reveal sensitive information instead of hacking systems" }
                        },
                        {
                            question: { ar: "ما هو التشفير من طرف إلى طرف (End-to-End Encryption)؟", en: "What is End-to-End Encryption?" },
                            answers: {
                                ar: ["تشفير البيانات على الخادم فقط", "تشفير البيانات بين المرسل والمستقبل فقط", "تشفير جزئي للبيانات", "تشفير بدون مفتاح"],
                                en: ["Encrypting data only on the server", "Encrypting data only between sender and receiver", "Partial data encryption", "Encryption without keys"]
                            },
                            correct: 1,
                            explanation: { ar: "التشفير من طرف إلى طرف يضمن أن البيانات مشفرة بين المرسل والمستقبل فقط ولا يمكن فكها أثناء transit", en: "End-to-end encryption ensures data is encrypted only between sender and receiver and cannot be decrypted in transit" }
                        },
                        {
                            question: { ar: "ما هو هجوم رفض الخدمة الموزع (DDoS)؟", en: "What is a Distributed Denial of Service (DDoS) attack?" },
                            answers: {
                                ar: ["هجوم من مصدر واحد", "هجوم من عدة مصادر في وقت واحد", "هجوم على كلمات المرور", "هجوم على التطبيقات"],
                                en: ["Attack from a single source", "Attack from multiple sources simultaneously", "Attack on passwords", "Attack on applications"]
                            },
                            correct: 1,
                            explanation: { ar: "هجوم DDoS يغرق الخادم بطلبات من عدة مصادر مما يجعله غير قادر على الاستجابة للطلبات الشرعية", en: "DDoS attack floods server with requests from multiple sources making it unable to respond to legitimate requests" }
                        },
                        {
                            question: { ar: "ما هو اختبار الثغرات (Vulnerability Assessment)؟", en: "What is Vulnerability Assessment?" },
                            answers: {
                                ar: ["هجوم على الأنظمة", "فحص منهجي للثغرات الأمنية", "تحليل البيانات", "مراقبة الشبكة"],
                                en: ["Attack on systems", "Systematic examination of security vulnerabilities", "Data analysis", "Network monitoring"]
                            },
                            correct: 1,
                            explanation: { ar: "اختبار الثغرات هو عملية منهجية لتحديد وتصنيف وإبلاغ الثغرات الأمنية في الأنظمة", en: "Vulnerability assessment is systematic process of identifying, classifying and reporting security vulnerabilities in systems" }
                        }
                    ],
                    advanced: [
                        {
                            question: { ar: "ما هو الاختلاف بين التهديد والضعف؟", en: "What is the difference between threat and vulnerability?" },
                            answers: {
                                ar: ["لا يوجد فرق", "التهديد هو خطر محتمل، الضعف هو نقطة ضعف", "التهديد هو نقطة ضعف، الضعف هو خطر محتمل", "كلاهما نفس المعنى"],
                                en: ["No difference", "Threat is potential danger, vulnerability is weakness", "Threat is weakness, vulnerability is potential danger", "Both mean the same"]
                            },
                            correct: 1,
                            explanation: { ar: "التهديد هو خطر محتمل يمكن استغلاله، بينما الضعف هو نقطة ضعف في النظام", en: "Threat is potential danger that can be exploited, while vulnerability is weakness in the system" }
                        },
                        {
                            question: { ar: "ما هو نموذج CIA في الأمن السيبراني؟", en: "What is the CIA model in cybersecurity?" },
                            answers: {
                                ar: ["السرية والنزاهة والتوافر", "الحوسبة والإنترنت والتطبيقات", "التشفير والتوثيق والتحقق", "الشبكات والأنظمة والتطبيقات"],
                                en: ["Confidentiality, Integrity, Availability", "Computing, Internet, Applications", "Encryption, Authentication, Verification", "Networks, Systems, Applications"]
                            },
                            correct: 0,
                            explanation: { ar: "نموذج CIA يمثل الركائز الأساسية للأمن: السرية والنزاهة والتوافر", en: "CIA model represents core principles of security: Confidentiality, Integrity, Availability" }
                        },
                        {
                            question: { ar: "ما هو الاختلاف بين التشفير المتماثل وغير المتماثل؟", en: "What is the difference between symmetric and asymmetric encryption?" },
                            answers: {
                                ar: ["لا يوجد فرق", "المتماثل يستخدم مفتاحاً واحداً، غير المتماثل يستخدم مفتاحين", "المتماثل أبطأ", "غير المتماثل أقل أماناً"],
                                en: ["No difference", "Symmetric uses one key, asymmetric uses two keys", "Symmetric is slower", "Asymmetric is less secure"]
                            },
                            correct: 1,
                            explanation: { ar: "التشفير المتماثل يستخدم مفتاحاً واحداً للتشفير وفك التشفير، بينما غير المتماثل يستخدم مفتاحين: عام وخاص", en: "Symmetric encryption uses one key for encryption and decryption, while asymmetric uses two keys: public and private" }
                        },
                        {
                            question: { ar: "ما هو هجوم إعادة التشغيل (Replay Attack)؟", en: "What is a Replay Attack?" },
                            answers: {
                                ar: ["إعادة تشغيل الجهاز", "إعادة إرسال بيانات مسروقة", "هجوم على الذاكرة", "هجوم على المعالج"],
                                en: ["Restarting the device", "Resending stolen data", "Memory attack", "Processor attack"]
                            },
                            correct: 1,
                            explanation: { ar: "هجوم إعادة التشغيل يعيد إرسال بيانات مسروقة صالحة للخداع بالوصول غير المصرح به", en: "Replay attack resends valid stolen data to gain unauthorized access" }
                        },
                        {
                            question: { ar: "ما هو الاختلاف بين التهديد الداخلي والخارجي؟", en: "What is the difference between internal and external threat?" },
                            answers: {
                                ar: ["لا يوجد فرق", "الداخلي من داخل المنظمة، الخارجي من خارجها", "الداخلي أقل خطورة", "الخارجي غير موجود"],
                                en: ["No difference", "Internal from inside organization, external from outside", "Internal is less dangerous", "External doesn't exist"]
                            },
                            correct: 1,
                            explanation: { ar: "التهديدات الداخلية تأتي من موظفين أو أشخاص داخل المنظمة، بينما الخارجية تأتي من خارجها", en: "Internal threats come from employees or people inside organization, while external come from outside" }
                        },
                        {
                            question: { ar: "ما هو اختبار القلم الأبيض مقابل الأسود؟", en: "What is White Box vs Black Box testing?" },
                            answers: {
                                ar: ["لا يوجد فرق", "الأبيض مع معرفة النظام، الأسود بدون معرفة", "الأبيض للأنظمة الصغيرة", "الأسود أكثر تعقيداً"],
                                en: ["No difference", "White box with system knowledge, black box without", "White box for small systems", "Black box more complex"]
                            },
                            correct: 1,
                            explanation: { ar: "اختبار الصندوق الأبيض يتم مع معرفة كاملة بالنظام، بينما الأسود يتم بدون أي معرفة مسبقة", en: "White box testing is done with full system knowledge, while black box without any prior knowledge" }
                        },
                        {
                            question: { ar: "ما هو نموذج OSI؟", en: "What is the OSI model?" },
                            answers: {
                                ar: ["نموذج للشبكات يضم 7 طبقات", "نموذج للأمن", "نموذج للبرمجة", "نموذج للتشفير"],
                                en: ["Networking model with 7 layers", "Security model", "Programming model", "Encryption model"]
                            },
                            correct: 0,
                            explanation: { ar: "نموذج OSI هو إطار نظري يصف وظائف الشبكة عبر 7 طبقات مختلفة", en: "OSI model is theoretical framework describing network functions across 7 different layers" }
                        },
                        {
                            question: { ar: "ما هو الاختلاف بين التصيد والتصيد بالرمح؟", en: "What is the difference between phishing and spear phishing?" },
                            answers: {
                                ar: ["لا يوجد فرق", "التصيد عشوائي، التصيد بالرمح موجه", "التصيد بالرمح أسهل", "التصيد لا يستخدم البريد"],
                                en: ["No difference", "Phishing is random, spear phishing is targeted", "Spear phishing is easier", "Phishing doesn't use email"]
                            },
                            correct: 1,
                            explanation: { ar: "التصيد يرسل رسائل عشوائية للعديد من الأشخاص، بينما التصيد بالرمح يستهدف أفراداً محددين", en: "Phishing sends random messages to many people, while spear phishing targets specific individuals" }
                        },
                        {
                            question: { ar: "ما هو هجوم حجب الخدمة (DoS)؟", en: "What is a Denial of Service (DoS) attack?" },
                            answers: {
                                ar: ["هجوم لسرقة البيانات", "هجوم لجعل الخدمة غير متاحة", "هجوم لتغيير البيانات", "هجوم لمراقبة الشبكة"],
                                en: ["Attack to steal data", "Attack to make service unavailable", "Attack to change data", "Attack to monitor network"]
                            },
                            correct: 1,
                            explanation: { ar: "هجوم حجب الخدمة يهدف إلى جعل المورد أو الخدمة غير متاحة للمستخدمين الشرعيين", en: "Denial of Service attack aims to make resource or service unavailable to legitimate users" }
                        },
                        {
                            question: { ar: "ما هو الاختلاف بين التهديد والهجوم؟", en: "What is the difference between threat and attack?" },
                            answers: {
                                ar: ["لا يوجد فرق", "التهديد خطر محتمل، الهجوم تنفيذ فعلي", "التهديد أكثر خطورة", "الهجوم غير موجود"],
                                en: ["No difference", "Threat is potential danger, attack is actual execution", "Threat is more dangerous", "Attack doesn't exist"]
                            },
                            correct: 1,
                            explanation: { ar: "التهديد هو خطر محتمل، بينما الهجوم هو التنفيذ الفعلي لمحاولة استغلال الثغرة", en: "Threat is potential danger, while attack is actual execution of attempt to exploit vulnerability" }
                        }
                    ],
                    simulation: {
                        phishing: [
                            {
                                question: { ar: "كيف تتعرف على بريد تصيد احتيالي؟", en: "How do you identify a phishing email?" },
                                answers: {
                                    ar: ["عنوان المرسل غير مألوف", "يطلب معلومات شخصية", "يحتوي على أخطاء إملائية", "جميع ما سبق"],
                                    en: ["Unfamiliar sender address", "Requests personal information", "Contains spelling errors", "All of the above"]
                                },
                                correct: 3,
                                explanation: { ar: "بريد التصيد عادةً يحتوي على عناوين مرسلين مشبوهة ويطلب معلومات شخصية ويحتوي أخطاء", en: "Phishing email usually contains suspicious sender addresses, requests personal information and contains errors" }
                            },
                            {
                                question: { ar: "ماذا تفعل إذا تلقيت بريد تصيد؟", en: "What do you do if you receive a phishing email?" },
                                answers: {
                                    ar: ["تفتحه وتنقر على الروابط", "تحذفه مباشرة", "ترسله للأمان المعلوماتي", "الخياران 2 و 3"],
                                    en: ["Open it and click links", "Delete it immediately", "Send it to information security", "Options 2 and 3"]
                                },
                                correct: 3,
                                explanation: { ar: "يجب حذف بريد التصيد وإبلاغ قسم الأمان المعلوماتي للمساعدة في حماية الآخرين", en: "You should delete phishing email and report to information security department to help protect others" }
                            }
                        ],
                        ddos: [
                            {
                                question: { ar: "ما هو أفضل إجراء عند التعرض لهجوم DDoS؟", en: "What is the best action when facing a DDoS attack?" },
                                answers: {
                                    ar: ["إغلاق الخادم", "الاتصال بالإنترنت", "استخدام خدمات التخفيف", "إعادة تشغيل النظام"],
                                    en: ["Shut down the server", "Contact the internet", "Use mitigation services", "Restart the system"]
                                },
                                correct: 2,
                                explanation: { ar: "خدمات التخفيف المتخصصة يمكنها تصفية الحركة الضارة والسماح بالحركة الشرعية", en: "Specialized mitigation services can filter malicious traffic and allow legitimate traffic" }
                            },
                            {
                                question: { ar: "كيف تمنع هجوم DDoS؟", en: "How do you prevent DDoS attacks?" },
                                answers: {
                                    ar: ["زيادة سعة النطاق الترددي", "استخدام جدران حماية متخصصة", "توزيع الحمل على عدة خوادم", "جميع ما سبق"],
                                    en: ["Increase bandwidth capacity", "Use specialized firewalls", "Distribute load across multiple servers", "All of the above"]
                                },
                                correct: 3,
                                explanation: { ar: "الوقاية من DDoS تتطلب استراتيجية متعددة الطبقات تشمل زيادة السعة والجدران النارية وتوزيع الحمل", en: "DDoS prevention requires multi-layered strategy including capacity increase, firewalls and load distribution" }
                            }
                        ],
                        malware: [
                            {
                                question: { ar: "كيف تمنع إصابة جهازك بالبرمجيات الخبيثة؟", en: "How do you prevent malware infection on your device?" },
                                answers: {
                                    ar: ["عدم استخدام الإنترنت", "تثبيت برامج مكافحة فيروسات", "فتح جميع المرفقات", "تعطيل جدار الحماية"],
                                    en: ["Don't use internet", "Install antivirus software", "Open all attachments", "Disable firewall"]
                                },
                                correct: 1,
                                explanation: { ar: "برامج مكافحة الفيروسات تحمي جهازك من البرمجيات الخبيثة مع تحديثات مستمرة", en: "Antivirus software protects your device from malware with continuous updates" }
                            },
                            {
                                question: { ar: "ما هي علامات إصابة الجهاز بالبرمجيات الخبيثة؟", en: "What are signs of malware infection on a device?" },
                                answers: {
                                    ar: ["بطء الأداء", "ظهور نوافذ منبثقة", "زيادة استخدام الشبكة", "جميع ما سبق"],
                                    en: ["Slow performance", "Popup windows appearing", "Increased network usage", "All of the above"]
                                },
                                correct: 3,
                                explanation: { ar: "البرمجيات الخبيثة تسبب بطء الأداء ونوافذ منبثقة غير مرغوب فيها وزيادة غير طبيعية في استخدام الشبكة", en: "Malware causes slow performance, unwanted popup windows and abnormal increase in network usage" }
                            }
                        ],
                        social: [
                            {
                                question: { ar: "كيف تحمي نفسك من هجمات الهندسة الاجتماعية؟", en: "How do you protect yourself from social engineering attacks?" },
                                answers: {
                                    ar: ["مشاركة جميع المعلومات", "التأكد من هوية المتصل", "الرد على جميع الرسائل", "استخدام نفس كلمة المرور"],
                                    en: ["Share all information", "Verify caller identity", "Reply to all messages", "Use same password"]
                                },
                                correct: 1,
                                explanation: { ar: "الهندسة الاجتماعية تعتمد على الخداع، لذا يجب التأكد دائمًا من هوية من يطلب المعلومات", en: "Social engineering relies on deception, so always verify the identity of anyone requesting information" }
                            },
                            {
                                question: { ar: "ما هو أكثر أنواع الهندسة الاجتماعية شيوعاً؟", en: "What is the most common type of social engineering?" },
                                answers: {
                                    ar: ["التصيد الاحتيالي", "التهديدات الهاتفية", "التصيد بالرمح", "الانتحال الشخصي"],
                                    en: ["Phishing", "Phone threats", "Spear phishing", "Impersonation"]
                                },
                                correct: 0,
                                explanation: { ar: "التصيد الاحتيالي هو أكثر أنواع الهندسة الاجتماعية شيوعاً حيث يرسل المهاجمون رسائل جماعية لخداع الضحايا", en: "Phishing is the most common type of social engineering where attackers send mass messages to trick victims" }
                            }
                        ]
                    }
                };
            },
            
            loadLeaderboard() {
                const saved = localStorage.getItem('cyber_defender_leaderboard');
                this.leaderboard = saved ? JSON.parse(saved) : [
                    { name: "حيدر", score: 1500 },
                    { name: "أحمد", score: 1200 },
                    { name: "محمد", score: 900 },
                    { name: "فاطمة", score: 800 },
                    { name: "علي", score: 700 }
                ];
            },
            
            loadHighScore() {
                const saved = localStorage.getItem('cyber_defender_highscore');
                const highScore = saved ? parseInt(saved) : 0;
                document.getElementById('highScore').textContent = highScore;
            },
            
            saveHighScore() {
                localStorage.setItem('cyber_defender_highscore', this.score.toString());
            },
            
            saveLeaderboard() {
                localStorage.setItem('cyber_defender_leaderboard', JSON.stringify(this.leaderboard));
            },
            
            loadPlayerStats() {
                const saved = localStorage.getItem('cyber_defender_stats');
                if (saved) {
                    this.playerStats = JSON.parse(saved);
                }
            },
            
            savePlayerStats() {
                localStorage.setItem('cyber_defender_stats', JSON.stringify(this.playerStats));
                this.updateStatsDisplay();
            },
            
            // الدوال الأساسية المصلحة
            startGame() {
                const questions = this.questions[this.currentLevel];
                if (!questions || questions.length === 0) {
                    this.showMessage('❌ لا توجد أسئلة متاحة لهذا المستوى', 'error');
                    return;
                }
                
                this.currentQuestion = 0;
                this.score = 0;
                this.updateProgress();
                this.showGameQuestion(questions, 'normal');
            },
            
            startAdvancedQuestions() {
                const questions = this.questions.advanced;
                if (!questions || questions.length === 0) {
                    this.showMessage('❌ لا توجد أسئلة متقدمة متاحة', 'error');
                    return;
                }
                
                this.currentQuestion = 0;
                this.score = 0;
                this.updateProgress();
                this.showGameQuestion(questions, 'advanced');
            },
            
            startDailyChallenge() {
                if (this.dailyChallenge.completed) {
                    this.showMessage('🎉 لقد أكملت التحدي اليومي بالفعل! عد غداً لتحدي جديد.', 'info');
                    return;
                }
                
                if (this.dailyChallenge.currentQuestion) {
                    this.currentQuestion = 0;
                    this.score = 0;
                    this.showGameQuestion([this.dailyChallenge.currentQuestion], 'daily');
                } else {
                    this.showMessage('❌ لا يوجد تحدٍ يومي متاح حالياً', 'error');
                }
            },
            
            showGameQuestion(questions, mode) {
                if (this.currentQuestion >= questions.length) {
                    this.finishGame(mode);
                    return;
                }
                
                const question = questions[this.currentQuestion];
                const modal = document.createElement('div');
                modal.className = 'game-modal';
                modal.innerHTML = `
                    <div class="game-content">
                        <div class="game-stats">
                            <span>${this.translate('score')}: ${this.score}</span>
                            <span>${this.translate('question')}: ${this.currentQuestion + 1}/${questions.length}</span>
                            <span>${this.translate('level')}: ${this.getLevelText(this.currentLevel)}</span>
                        </div>
                        
                        <div class="game-question">
                            ${question.question[this.currentLanguage]}
                        </div>
                        
                        <div class="game-answers">
                            ${question.answers[this.currentLanguage].map((answer, index) => `
                                <button class="game-answer-btn" onclick="gameManager.checkAnswer(${index}, ${question.correct}, '${mode}')">
                                    ${String.fromCharCode(1632 + index + 1)}. ${answer}
                                </button>
                            `).join('')}
                        </div>
                        
                        <div class="game-buttons">
                            <button onclick="gameManager.closeModal()">${this.translate('close')}</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
            },
            
            checkAnswer(selected, correct, mode) {
                this.playerStats.totalQuestions++;
                this.playerStats.weeklyStats.questions++;
                
                const answerButtons = document.querySelectorAll('.game-answer-btn');
                let points = 0;
                
                switch(this.currentLevel) {
                    case 'easy': points = 50; break;
                    case 'medium': points = 100; break;
                    case 'hard': points = 200; break;
                    default: points = 100;
                }
                
                if (mode === 'daily') points = 200;
                if (mode === 'advanced') points = 150;
                if (mode === 'simulation') points = 100;
                
                answerButtons.forEach((btn, index) => {
                    if (index === correct) {
                        btn.classList.add('correct');
                    } else if (index === selected) {
                        btn.classList.add('wrong');
                    }
                    btn.style.pointerEvents = 'none';
                });
                
                const questions = mode === 'advanced' ? this.questions.advanced : 
                                mode === 'daily' ? [this.dailyChallenge.currentQuestion] : 
                                mode === 'simulation' ? this.questions.simulation[this.currentSimulationType] :
                                this.questions[this.currentLevel];
                
                const question = questions[this.currentQuestion];
                
                if (selected === correct) {
                    this.score += points;
                    this.playerStats.correctAnswers++;
                    this.playerStats.weeklyStats.points += points;
                    this.showMessage(`🎉 ${this.translate('correct')}! +${points} ${this.translate('points')}`, 'success');
                } else {
                    this.showMessage(`❌ ${this.translate('wrong')}! الإجابة الصحيحة: ${question.answers[this.currentLanguage][correct]}`, 'error');
                }

                setTimeout(() => {
                    this.closeModal();
                    this.currentQuestion++;
                    this.updateProgress();
                    this.savePlayerStats();
                    this.updateStatsDisplay();
                    this.updateWeeklyStats();
                    
                    if (this.currentQuestion < questions.length) {
                        this.showGameQuestion(questions, mode);
                    } else {
                        this.finishGame(mode);
                    }
                }, 3000);
            },
            
            updateProgress() {
                const questions = this.questions[this.currentLevel];
                const progressPercent = (this.currentQuestion / questions.length) * 100;
                document.getElementById('progressFill').style.width = `${progressPercent}%`;
                document.getElementById('progressText').textContent = 
                    `${this.translate('question')} ${this.currentQuestion} ${this.translate('from')} ${questions.length}`;
            },
            
            finishGame(mode) {
                let message = '';
                if (mode === 'daily') {
                    message = `🏆 ${this.translate('challenge_completed')}! ${this.translate('score')}: ${this.score}`;
                    this.dailyChallenge.completed = true;
                    this.saveDailyChallenge();
                    this.updateChallengeDisplay();
                } else if (mode === 'simulation') {
                    message = `🛡️ ${this.translate('simulation_completed')}! ${this.translate('score')}: ${this.score}`;
                } else {
                    message = `🏆 ${this.translate('game_completed')}! ${this.translate('score')}: ${this.score}`;
                }
                
                this.showMessage(message, 'success');
                
                const highScoreElement = document.getElementById('highScore');
                const currentHighScore = parseInt(highScoreElement.textContent);
                if (this.score > currentHighScore) {
                    highScoreElement.textContent = this.score;
                    this.saveHighScore();
                    this.showMessage('🎯 ' + this.translate('new_highscore'), 'success');
                }
                
                // إضافة اللاعب للوحة المتصدرين
                this.addToLeaderboard(this.playerProfile.name, this.score);
            },
            
            saveDailyChallenge() {
                const dailyData = {
                    completed: this.dailyChallenge.completed,
                    lastDate: new Date().toDateString()
                };
                localStorage.setItem('cyber_defender_daily', JSON.stringify(dailyData));
            },
            
            closeModal() {
                const modal = document.querySelector('.game-modal, .leaderboard-modal, .challenge-modal');
                if (modal) modal.remove();
            },
            
            showHowToPlay() {
                const rules = this.currentLanguage === 'ar' 
                    ? "قواعد اللعبة:\n\n1. اختر مستوى الصعوبة\n2. أجب على الأسئلة بشكل صحيح\n3. احصل على النقاط:\n   - سهل: 50 نقطة\n   - متوسط: 100 نقطة\n   - صعب: 200 نقطة\n4. تقدم في المستويات\n5. شارك في التحديات اليومية"
                    : "Game Rules:\n\n1. Choose difficulty level\n2. Answer questions correctly\n3. Earn points:\n   - Easy: 50 points\n   - Medium: 100 points\n   - Hard: 200 points\n4. Advance through levels\n5. Participate in daily challenges";
                
                alert(rules);
            },
            
            selectLevel(level) {
                this.currentLevel = level;
                
                document.querySelectorAll('.level-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                event.target.classList.add('active');
                
                this.showMessage(
                    this.currentLanguage === 'ar' 
                        ? `✅ تم اختيار المستوى: ${this.getLevelText(level)}`
                        : `✅ Selected level: ${this.getLevelText(level)}`,
                    'success'
                );
            },
            
            getLevelText(level) {
                const levels = {
                    easy: { ar: 'سهل', en: 'Easy' },
                    medium: { ar: 'متوسط', en: 'Medium' },
                    hard: { ar: 'صعب', en: 'Hard' }
                };
                return levels[level][this.currentLanguage];
            },
            
            deleteRecord() {
                if (confirm(this.currentLanguage === 'ar' ? 'هل تريد حذف السجل؟' : 'Delete record?')) {
                    document.getElementById('highScore').textContent = '0';
                    localStorage.removeItem('cyber_defender_highscore');
                    this.showMessage(
                        this.currentLanguage === 'ar' ? '🗑️ تم حذف السجل' : '🗑️ Record deleted',
                        'info'
                    );
                }
            },
            
            copyScore() {
                const score = document.getElementById('highScore').textContent;
                navigator.clipboard.writeText(score);
                this.showMessage(
                    this.currentLanguage === 'ar' ? '📋 تم نسخ النتيجة' : '📋 Score copied',
                    'success'
                );
            },
            
            showLeaderboard() {
                const modal = document.createElement('div');
                modal.className = 'leaderboard-modal';
                modal.innerHTML = `
                    <div class="leaderboard-content">
                        <h3>${this.translate('topPlayers')}</h3>
                        <div class="leaderboard-list">
                            ${this.leaderboard.map((player, index) => `
                                <div class="leaderboard-item">
                                    <div class="leaderboard-rank ${index < 3 ? 'rank-' + (index + 1) : ''}">
                                        ${index + 1}
                                    </div>
                                    <div class="leaderboard-name">${player.name}</div>
                                    <div class="leaderboard-score">${player.score} ${this.translate('points')}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div style="margin-top: 20px; padding: 15px; background: rgba(45, 212, 191, 0.1); border-radius: 8px;">
                            <strong>${this.translate('yourScore')}: ${this.score}</strong>
                        </div>
                        <div class="challenge-buttons" style="margin-top: 20px;">
                            <button onclick="gameManager.closeModal()">${this.translate('close')}</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
            },
            
            showAchievements() {
                const modal = document.createElement('div');
                modal.className = 'game-modal';
                modal.innerHTML = `
                    <div class="game-content">
                        <h3>🏆 الإنجازات</h3>
                        <div class="achievements-grid" style="margin: 20px 0;">
                            <div class="achievement-card ${this.playerStats.totalQuestions >= 10 ? '' : 'locked'}">
                                <div class="achievement-icon">🥇</div>
                                <div class="achievement-title">المبتدئ</div>
                                <div class="achievement-desc">أكمل 10 أسئلة</div>
                            </div>
                            <div class="achievement-card ${this.playerStats.totalQuestions >= 50 ? '' : 'locked'}">
                                <div class="achievement-icon">🥈</div>
                                <div class="achievement-title">المحترف</div>
                                <div class="achievement-desc">أكمل 50 سؤالاً</div>
                            </div>
                            <div class="achievement-card ${this.playerStats.totalQuestions >= 100 ? '' : 'locked'}">
                                <div class="achievement-icon">🥉</div>
                                <div class="achievement-title">الخبير</div>
                                <div class="achievement-desc">أكمل 100 سؤال</div>
                            </div>
                            <div class="achievement-card ${this.playerStats.correctAnswers >= 20 ? '' : 'locked'}">
                                <div class="achievement-icon">⚡</div>
                                <div class="achievement-title">سريع</div>
                                <div class="achievement-desc">أجب على 20 سؤالاً صحيحاً</div>
                            </div>
                        </div>
                        <div class="game-buttons">
                            <button onclick="gameManager.closeModal()">${this.translate('close')}</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
            },
            
            addToLeaderboard(name, score) {
                this.leaderboard.push({ name, score });
                this.leaderboard.sort((a, b) => b.score - a.score);
                this.leaderboard = this.leaderboard.slice(0, 10);
                this.saveLeaderboard();
            },
            
            startSimulation(type) {
                this.currentSimulationType = type;
                const questions = this.questions.simulation[type];
                if (questions && questions.length > 0) {
                    this.currentQuestion = 0;
                    this.score = 0;
                    this.showGameQuestion(questions, 'simulation');
                } else {
                    this.showMessage('❌ لا توجد أسئلة متاحة لهذا النوع من المحاكاة', 'error');
                }
            },
            
            switchLanguage(lang) {
                this.currentLanguage = lang;
                document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
                document.documentElement.lang = lang;
                
                document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`.lang-btn[onclick="gameManager.switchLanguage('${lang}')"]`).classList.add('active');
                
                this.updateTexts();
                this.showMessage(
                    lang === 'ar' ? '🌐 تم التبديل إلى اللغة العربية' : '🌐 Switched to English',
                    'success'
                );
            },
            
            updateTexts() {
                const translations = {
                    ar: {
                        score: "النقاط",
                        question: "السؤال",
                        level: "المستوى",
                        close: "إغلاق",
                        correct: "إجابة صحيحة",
                        wrong: "إجابة خاطئة",
                        points: "نقطة",
                        challenge_completed: "اكتمل التحدي",
                        simulation_completed: "اكتملت المحاكاة",
                        game_completed: "اكتملت اللعبة",
                        new_highscore: "رقم قياسي جديد!",
                        topPlayers: "أفضل اللاعبين",
                        yourScore: "نتيجتك"
                    },
                    en: {
                        score: "Score",
                        question: "Question",
                        level: "Level",
                        close: "Close",
                        correct: "Correct",
                        wrong: "Wrong",
                        points: "points",
                        challenge_completed: "Challenge completed",
                        simulation_completed: "Simulation completed",
                        game_completed: "Game completed",
                        new_highscore: "New high score!",
                        topPlayers: "Top Players",
                        yourScore: "Your Score"
                    }
                };
                
                this.translations = translations;
            },
            
            translate(key) {
                return this.translations?.[this.currentLanguage]?.[key] || key;
            },
            
            showMessage(message, type = 'info') {
                const messageDiv = document.createElement('div');
                messageDiv.className = `enhanced-message ${type}`;
                messageDiv.textContent = message;
                document.body.appendChild(messageDiv);
                
                setTimeout(() => {
                    if (messageDiv.parentElement) {
                        messageDiv.remove();
                    }
                }, 3000);
            },
            
            changeTheme(theme) {
                const themes = {
                    blue: { primary: '#3b82f6', secondary: '#1d4ed8' },
                    green: { primary: '#10b981', secondary: '#047857' },
                    purple: { primary: '#8b5cf6', secondary: '#7c3aed' },
                    orange: { primary: '#f59e0b', secondary: '#d97706' }
                };
                
                const selected = themes[theme];
                document.documentElement.style.setProperty('--primary-color', selected.primary);
                document.documentElement.style.setProperty('--secondary-color', selected.secondary);
                
                document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');
                
                this.showMessage(`🎨 تم تغيير الثيم إلى ${theme}`, 'success');
            },
            
            toggleAIChat() {
                const chat = document.getElementById('aiChat');
                chat.classList.toggle('active');
            },
            
            async sendAIMessage() {
                const input = document.getElementById('aiInput');
                const messages = document.getElementById('aiMessages');
                const question = input.value.trim();
                
                if (question) {
                    // إضافة سؤال المستخدم
                    messages.innerHTML += `
                        <div class="ai-message ai-user">
                            ${question}
                        </div>
                    `;
                    
                    // إضافة مؤشر الكتابة
                    messages.innerHTML += `
                        <div class="ai-message ai-bot">
                            <div class="typing-indicator">
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                            </div>
                            جاري البحث عن الإجابة...
                        </div>
                    `;
                    
                    messages.scrollTop = messages.scrollHeight;
                    
                    try {
                        const response = await this.getAIResponse(question);
                        
                        // إزالة مؤشر الكتابة
                        messages.innerHTML = messages.innerHTML.replace(/<div class="ai-message ai-bot">[\s\S]*?جاري البحث عن الإجابة...<\/div>/, '');
                        
                        // إضافة رد الذكاء الاصطناعي
                        messages.innerHTML += `
                            <div class="ai-message ai-bot">
                                ${response}
                            </div>
                        `;
                    } catch (error) {
                        // إزالة مؤشر الكتابة
                        messages.innerHTML = messages.innerHTML.replace(/<div class="ai-message ai-bot">[\s\S]*?جاري البحث عن الإجابة...<\/div>/, '');
                        
                        // إضافة رد بديل
                        messages.innerHTML += `
                            <div class="ai-message ai-bot">
                                عذراً، حدث خطأ في الاتصال. إليك بعض النصائح العامة:<br><br>
                                • استخدم كلمات مرور قوية وفريدة لكل حساب<br>
                                • فعّل المصادقة الثنائية<br>
                                • احرص على تحديث برامجك باستمرار<br>
                                • تجنب فتح الروابط المشبوهة<br>
                                • استخدم VPN على الشبكات العامة
                            </div>
                        `;
                    }
                    
                    messages.scrollTop = messages.scrollHeight;
                    input.value = '';
                }
            },
            
            async getAIResponse(question) {
                // قاعدة معرفية موسعة ومتخصصة في الأمن السيبراني
                const cybersecurityKnowledge = {
                    ar: {
                        "كلمة المرور": "**كلمات المرور الآمنة:**\n\n• استخدم 12 حرفاً على الأقل\n• مزج بين أحرف كبيرة وصغيرة وأرقام ورموز\n• لا تستخدم معلومات شخصية مثل تاريخ الميلاد\n• استخدم مدير كلمات المرور مثل LastPass أو Bitwarden\n• غيّر كلمات المرور بانتظام خاصة بعد حوادث الاختراق\n• لا تستخدم نفس كلمة المرور لمواقع متعددة\n\n**مثال لكلمة مرور قوية:**\n`MyP@ssw0rd!2024` أو `S3cur!tyR0cks#2024`",
                        
                        "التصيد": "**التعرف على هجمات التصيد:**\n\n• افحص عنوان البريد الإلكتروني للمرسل بدقة\n• ابحث عن الأخطاء الإملائية والنحوية\n• لا تضغط على الروابط المشبوهة - افحصها أولاً\n• تحقق من عناوين URL (قد تبدو مشابهة للمواقع الحقيقية)\n• اتصل بالمصدر للتأكد عبر قناة اتصال أخرى\n• لا تفتح المرفقات غير المتوقعة\n\n**علامات التحذير:**\n• طلب معلومات شخصية أو مالية\n• إلحاح في التنفيذ أو تهديدات\n• عروض مالية مغرية وغير واقعية\n• أخطاء في كتابة اسمك أو معلوماتك",
                        
                        "الفيروسات": "**الوقاية من البرمجيات الخبيثة:**\n\n• استخدم برامج مكافحة فيروسات موثوقة ومحدثة\n• حافظ على تحديث نظام التشغيل وجميع التطبيقات\n• تجنب التحميل من مصادر غير معروفة أو غير موثوقة\n• لا تفتح المرفقات المشبوهة في البريد الإلكتروني\n• استخدم جدار الحماية (Firewall)\n• احذر من البرمجيات المقرصنة\n• قم بعمل نسخ احتياطي منتظم لبياناتك\n\n**برامج مكافحة فيروسات موصى بها:**\n• Windows Defender (مدمج في Windows)\n• Malwarebytes\n• Norton Antivirus\n• Kaspersky",
                        
                        "الشبكات": "**أمان الشبكات والاتصالات:**\n\n• استخدم VPN على الشبكات العامة لحماية بياناتك\n• فعّل تشفير WPA3 للشبكات اللاسلكية\n• غيّر كلمات مرور الموجه (Router) الافتراضية\n• استخدم شبكات منفصلة للضيوف\n• راقب الأجهزة المتصلة بشبكتك بانتظام\n• عطّل إدارة الموجه عن بعد\n• استخدم تصفية عنوان MAC\n\n**نصائح للواي فاي المنزلي:**\n• غير اسم الشبكة الافتراضي (SSID)\n• استخدم كلمة مرور قوية تحتوي على أحرف وأرقام ورموز\n• عطّل WPS (Wi-Fi Protected Setup)\n• أخفِ اسم شبكتك إذا أمكن",
                        
                        "مصادقة": "**المصادقة الثنائية (2FA):**\n\n• تضيف طبقة حماية إضافية لحساباتك\n• حتى إذا تم اختراق كلمة المرور، لا يمكن الدخول بدون الرمز الثاني\n• استخدم تطبيقات المصادقة مثل Google Authenticator أو Authy\n• تجنب استخدام الرسائل النصية (SMS) للمصادقة الثنائية عندما يكون هناك بدائل\n• احتفظ برموز الاستعادة في مكان آمن\n• فعّل المصادقة الثنائية على جميع الحسابات المهمة",
                        
                        "تحديث": "**أهمية التحديثات الأمنية:**\n\n• التحديثات تصلح الثغرات الأمنية المكتشفة\n• تأخر التحديث يعرضك لخطر الاستغلال\n• فعّل التحديثات التلقائية عندما يكون ذلك ممكناً\n• قم بتحديث نظام التشغيل، المتصفح، والتطبيقات بانتظام\n• تأكد من تحديث البرامج الثابتة (Firmware) للأجهزة\n• التحديثات لا تقتصر على البرامج فقط بل تشمل الأجهزة أيضاً",
                        
                        "شبكة": "**أمان الشبكات المنزلية:**\n\n• قم بتغيير بيانات الدخول الافتراضية للموجه\n• استخدم تشفير WPA2 أو WPA3\n• عطّل إدارة الموجه عن بعد\n• استخدم كلمة مرور قوية للشبكة\n• فعّل جدار الحماية المدمج في الموجه\n• حدّث البرامج الثابتة للموجه بانتظام\n• استخدم شبكة ضيوف للزوار",
                        
                        "بريد": "**أمان البريد الإلكتروني:**\n\n• استخدم كلمات مرور قوية وفريدة\n• فعّل المصادقة الثنائية\n• احذر من رسائل التصيد والاحتيال\n• لا تفتح مرفقات من مرسلين غير معروفين\n• تحقق من عناوين URL قبل النقر\n• استخدم خدمة بريد إلكتروني ذات سمعة جيدة في الأمان\n• قم بعمل نسخة احتياطية للبريد المهم",
                        
                        "هاتف": "**أمان الهواتف الذكية:**\n\n• استخدم قفل الشاشة (نمط، PIN، أو بصمة)\n• قم بتحديث نظام التشغيل والتطبيقات بانتظام\n• تنزيل التطبيقات من متاجر رسمية فقط\n• افحص الأذونات التي تطلبها التطبيقات\n• استخدم VPN على الشبكات العامة\n• فعّل المصادقة الثنائية للحسابات المهمة\n• قم بعمل نسخ احتياطي للبيانات المهمة",
                        
                        "default": "**نصائح أمنية عامة:**\n\n🔐 **الأساسيات:**\n• استخدم كلمات مرور قوية وفريدة لكل حساب\n• فعّل المصادقة الثنائية (2FA)\n• حافظ على تحديث برامجك وأنظمتك\n• قم بعمل نسخ احتياطي منتظم لبياناتك\n\n🛡️ **الحماية:**\n• استخدم برامج مكافحة الفيروسات\n• فعّل جدران الحماية\n• استخدم التشفير للبيانات الحساسة\n• احذر من شبكات Wi-Fi العامة\n\n📱 **أفضل الممارسات:**\n• كن حذراً من رسائل البريد المشبوهة\n• لا تشارك المعلومات الشخصية عبر الإنترنت\n• استخدم VPN على الشبكات العامة\n• تعلّم باستمرار عن التهديدات الأمنية الجديدة\n\n**تذكر:** الأمن السيبراني مسؤولية مشتركة ووعيك هو خط الدفاع الأول!"
                    }
                };
                
                const lang = this.currentLanguage;
                let response = cybersecurityKnowledge[lang].default;
                
                const questionLower = question.toLowerCase();
                
                if (questionLower.includes('كلمة مرور') || questionLower.includes('باسورد') || questionLower.includes('password')) {
                    response = cybersecurityKnowledge[lang]["كلمة المرور"];
                } else if (questionLower.includes('تصيد') || questionLower.includes('phishing')) {
                    response = cybersecurityKnowledge[lang]["التصيد"];
                } else if (questionLower.includes('فيروس') || questionLower.includes('ڤيروس') || questionLower.includes('malware') || questionLower.includes('virus')) {
                    response = cybersecurityKnowledge[lang]["الفيروسات"];
                } else if (questionLower.includes('شبكة') || questionLower.includes('نت') || questionLower.includes('network') || questionLower.includes('wifi') || questionLower.includes('واي فاي')) {
                    response = cybersecurityKnowledge[lang]["الشبكات"];
                } else if (questionLower.includes('مصادقة') || questionLower.includes('توثيق') || questionLower.includes('2fa') || questionLower.includes('authenticat')) {
                    response = cybersecurityKnowledge[lang]["مصادقة"];
                } else if (questionLower.includes('تحديث') || questionLower.includes('update') || questionLower.includes('upgrade')) {
                    response = cybersecurityKnowledge[lang]["تحديث"];
                } else if (questionLower.includes('بريد') || questionLower.includes('ايميل') || questionLower.includes('email') || questionLower.includes('outlook') || questionLower.includes('gmail')) {
                    response = cybersecurityKnowledge[lang]["بريد"];
                } else if (questionLower.includes('هاتف') || questionLower.includes('موبايل') || questionLower.includes('جوال') || questionLower.includes('phone') || questionLower.includes('mobile')) {
                    response = cybersecurityKnowledge[lang]["هاتف"];
                } else if (!questionLower.includes('أمن') && !questionLower.includes('سيبراني') && !questionLower.includes('security') && !questionLower.includes('cyber')) {
                    response = "عذراً، أنا متخصص في مجال الأمن السيبراني فقط. يمكنني مساعدتك في مواضيع مثل:\n\n• كلمات المرور الآمنة\n• الحماية من التصيد الاحتيالي\n• مكافحة الفيروسات والبرمجيات الخبيثة\n• أمان الشبكات والاتصالات\n• المصادقة الثنائية\n• التحديثات الأمنية\n• أمان البريد الإلكتروني\n• أمان الهواتف الذكية\n\nيرجى طرح سؤال متعلق بالأمن السيبراني.";
                }
                
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                return response;
            },
            
            updateStatsDisplay() {
                document.getElementById('totalQuestions').textContent = this.playerStats.totalQuestions;
                document.getElementById('correctAnswers').textContent = this.playerStats.correctAnswers;
                document.getElementById('successRate').textContent = 
                    this.playerStats.totalQuestions > 0 
                    ? Math.round((this.playerStats.correctAnswers / this.playerStats.totalQuestions) * 100) + '%'
                    : '0%';
                document.getElementById('timeSpent').textContent = Math.floor(this.playerStats.timeSpent / 60) + ' د';
                
                document.getElementById('characterName').textContent = this.character.name;
                document.getElementById('characterLevel').textContent = this.character.level;
                document.getElementById('characterXP').textContent = this.character.xp;
            },
            
            updateWeeklyStats() {
                const today = new Date().toDateString();
                const lastPlayed = this.playerStats.weeklyStats.lastPlayed;
                
                if (lastPlayed !== today) {
                    if (lastPlayed) {
                        const lastDate = new Date(lastPlayed);
                        const currentDate = new Date(today);
                        const diffTime = Math.abs(currentDate - lastDate);
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                        
                        if (diffDays === 1) {
                            this.playerStats.weeklyStats.streak++;
                        } else if (diffDays > 1) {
                            this.playerStats.weeklyStats.streak = 1;
                        }
                    } else {
                        this.playerStats.weeklyStats.streak = 1;
                    }
                    
                    this.playerStats.weeklyStats.lastPlayed = today;
                    this.savePlayerStats();
                }
                
                document.getElementById('weeklyQuestions').textContent = this.playerStats.weeklyStats.questions;
                document.getElementById('weeklyPoints').textContent = this.playerStats.weeklyStats.points;
                document.getElementById('streakDays').textContent = this.playerStats.weeklyStats.streak;
            },
            
            startTimer() {
                setInterval(() => {
                    this.playerStats.timeSpent++;
                    this.updateStatsDisplay();
                }, 1000);
            }
        };

        // بدء اللعبة عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            gameManager.init();
        });
    </script>
</body>
</html>
